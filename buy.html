<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - Safe Love</title>
    <style>
        /* Add your previous styles here */

    </style>
</head>

<body>

    <header>
        <h1>Checkout</h1>
    </header>

    <div class="container">
        <!-- Cart Items will be dynamically added here -->
        <div id="cartItemsContainer"></div>

        <!-- Total Price Display -->
        <div class="total" id="totalPrice">
            Total: $0.00
        </div>

        <button class="checkout-button" id="checkoutBtn">Proceed to Checkout</button>

        <div class="loading" id="loadingMessage">
            Please wait, processing your order...
        </div>
    </div>

    <script>
        // Price and cart data
        const cartContainer = document.getElementById('cartItemsContainer');
        const totalPriceElement = document.getElementById('totalPrice');
        const checkoutBtn = document.getElementById('checkoutBtn');
        const loadingMessage = document.getElementById('loadingMessage');

        // Load cart items from localStorage
        function loadCart() {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            let total = 0;

            cartContainer.innerHTML = ''; // Clear previous cart content

            cart.forEach(item => {
                // Add product to cart view
                const cartItemDiv = document.createElement('div');
                cartItemDiv.classList.add('cart-item');
                cartItemDiv.innerHTML = `
                    <div class="name">${item.productName}</div>
                    <div class="price">$${item.price.toFixed(2)}</div>
                    <div class="quantity-container">
                        <button class="decreaseBtn" data-name="${item.productName}">-</button>
                        <input type="number" class="quantityInput" value="${item.quantity}" min="1" data-name="${item.productName}">
                        <button class="increaseBtn" data-name="${item.productName}">+</button>
                    </div>
                `;
                cartContainer.appendChild(cartItemDiv);

                // Calculate total price
                total += item.price * item.quantity;
            });

            totalPriceElement.innerText = `Total: $${total.toFixed(2)}`;
        }

        // Update cart data in localStorage
        function updateCart(productName, quantity) {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const item = cart.find(i => i.productName === productName);
            if (item) {
                item.quantity = quantity;
            }
            localStorage.setItem('cart', JSON.stringify(cart));
        }

        // Handle Quantity Change
        cartContainer.addEventListener('click', function (e) {
            if (e.target.classList.contains('increaseBtn')) {
                const productName = e.target.dataset.name;
                const quantityInput = document.querySelector(`input[data-name="${productName}"]`);
                quantityInput.value = parseInt(quantityInput.value) + 1;
                updateCart(productName, quantityInput.value);
                loadCart();
            }
            if (e.target.classList.contains('decreaseBtn')) {
                const productName = e.target.dataset.name;
                const quantityInput = document.querySelector(`input[data-name="${productName}"]`);
                if (parseInt(quantityInput.value) > 1) {
                    quantityInput.value = parseInt(quantityInput.value) - 1;
                    updateCart(productName, quantityInput.value);
                    loadCart();
                }
            }
        });

        // Checkout action
        checkoutBtn.addEventListener('click', function () {
            checkoutBtn.style.display = 'none';
            loadingMessage.style.display = 'block';

            setTimeout(function () {
                window.location.href = "../Donebuy.html";
            }, 1000);
        });

        // Load the cart when the page loads
        loadCart();
    </script>

</body>

</html>
